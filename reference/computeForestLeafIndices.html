<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute and return a vector representation of a forest's leaf predictions for
every observation in a dataset.
The vector has a &quot;column-major&quot; format that can be easily re-represented as
as a CSC sparse matrix: elements are organized so that the first n elements
correspond to leaf predictions for all n observations in a dataset for the
first tree in an ensemble, the next n elements correspond to predictions for
the second tree and so on. The &quot;data&quot; for each element corresponds to a uniquely
mapped column index that corresponds to a single leaf of a single tree (i.e.
if tree 1 has 3 leaves, its column indices range from 0 to 2, and then tree 2's
leaf indices begin at 3, etc...).
Users may pass a single dataset (which we refer to here as a &quot;training set&quot;)
or two datasets (which we refer to as &quot;training and test sets&quot;). This verbiage
hints that one potential use-case for a matrix of leaf indices is to define a
ensemble-based kernel for kriging."><title>Compute and return a vector representation of a forest's leaf predictions for every observation in a dataset. The vector has a "column-major" format that can be easily re-represented as as a CSC sparse matrix: elements are organized so that the first n elements correspond to leaf predictions for all n observations in a dataset for the first tree in an ensemble, the next n elements correspond to predictions for the second tree and so on. The "data" for each element corresponds to a uniquely mapped column index that corresponds to a single leaf of a single tree (i.e. if tree 1 has 3 leaves, its column indices range from 0 to 2, and then tree 2's leaf indices begin at 3, etc...). Users may pass a single dataset (which we refer to here as a "training set") or two datasets (which we refer to as "training and test sets"). This verbiage hints that one potential use-case for a matrix of leaf indices is to define a ensemble-based kernel for kriging. — computeForestLeafIndices • stochtree</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute and return a vector representation of a forest's leaf predictions for every observation in a dataset. The vector has a " column-major format that can be easily re-represented as a csc sparse matrix: elements are organized so the first n correspond to leaf predictions for all observations in dataset tree an ensemble next second and on. each element corresponds uniquely mapped column index single of if has leaves its indices range from then begin at etc... users may pass we refer here set or two datasets test sets this verbiage hints one potential use-case matrix is define ensemble-based kernel kriging. computeforestleafindices><meta property="og:description" content="Compute and return a vector representation of a forest's leaf predictions for
every observation in a dataset.
The vector has a &quot;column-major&quot; format that can be easily re-represented as
as a CSC sparse matrix: elements are organized so that the first n elements
correspond to leaf predictions for all n observations in a dataset for the
first tree in an ensemble, the next n elements correspond to predictions for
the second tree and so on. The &quot;data&quot; for each element corresponds to a uniquely
mapped column index that corresponds to a single leaf of a single tree (i.e.
if tree 1 has 3 leaves, its column indices range from 0 to 2, and then tree 2's
leaf indices begin at 3, etc...).
Users may pass a single dataset (which we refer to here as a &quot;training set&quot;)
or two datasets (which we refer to as &quot;training and test sets&quot;). This verbiage
hints that one potential use-case for a matrix of leaf indices is to define a
ensemble-based kernel for kriging."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">stochtree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>High-Level Interface</h6>
    <a class="dropdown-item" href="../articles/BayesianSupervisedLearning.html">Bayesian Supervised Learning in StochTree</a>
    <a class="dropdown-item" href="../articles/CausalInference.html">Causal Machine Learning in StochTree</a>
    <a class="dropdown-item" href="../articles/ModelSerialization.html">Model Serialization in StochTree</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Prototype Interface</h6>
    <a class="dropdown-item" href="../articles/CustomSamplingRoutine.html">Custom Sampling Routines in StochTree</a>
    <a class="dropdown-item" href="../articles/EnsembleKernel.html">Kernel Methods from Tree Ensembles in StochTree</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute and return a vector representation of a forest's leaf predictions for every observation in a dataset. The vector has a "column-major" format that can be easily re-represented as as a CSC sparse matrix: elements are organized so that the first <code>n</code> elements correspond to leaf predictions for all <code>n</code> observations in a dataset for the first tree in an ensemble, the next <code>n</code> elements correspond to predictions for the second tree and so on. The "data" for each element corresponds to a uniquely mapped column index that corresponds to a single leaf of a single tree (i.e. if tree 1 has 3 leaves, its column indices range from 0 to 2, and then tree 2's leaf indices begin at 3, etc...). Users may pass a single dataset (which we refer to here as a "training set") or two datasets (which we refer to as "training and test sets"). This verbiage hints that one potential use-case for a matrix of leaf indices is to define a ensemble-based kernel for kriging.</h1>
      
      <div class="d-none name"><code>computeForestLeafIndices.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute and return a vector representation of a forest's leaf predictions for
every observation in a dataset.
The vector has a "column-major" format that can be easily re-represented as
as a CSC sparse matrix: elements are organized so that the first <code>n</code> elements
correspond to leaf predictions for all <code>n</code> observations in a dataset for the
first tree in an ensemble, the next <code>n</code> elements correspond to predictions for
the second tree and so on. The "data" for each element corresponds to a uniquely
mapped column index that corresponds to a single leaf of a single tree (i.e.
if tree 1 has 3 leaves, its column indices range from 0 to 2, and then tree 2's
leaf indices begin at 3, etc...).
Users may pass a single dataset (which we refer to here as a "training set")
or two datasets (which we refer to as "training and test sets"). This verbiage
hints that one potential use-case for a matrix of leaf indices is to define a
ensemble-based kernel for kriging.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">computeForestLeafIndices</span><span class="op">(</span><span class="va">bart_model</span>, <span class="va">X_train</span>, X_test <span class="op">=</span> <span class="cn">NULL</span>, forest_num <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>bart_model</dt>
<dd><p>Object of type <code>bartmodel</code> corresponding to a BART model with at least one sample</p></dd>


<dt>X_train</dt>
<dd><p>Matrix of "training" data. In a traditional Gaussian process kriging context, this
corresponds to the observations for which outcomes are observed.</p></dd>


<dt>X_test</dt>
<dd><p>(Optional) Matrix of "test" data. In a traditional Gaussian process kriging context, this
corresponds to the observations for which outcomes are unobserved and must be estimated
based on the kernels k(X_test,X_test), k(X_test,X_train), and k(X_train,X_train). If not provided,
this function will only compute k(X_train, X_train).</p></dd>


<dt>forest_num</dt>
<dd><p>(Option) Index of the forest sample to use for kernel computation. If not provided,
this function will use the last forest.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>List of vectors. If <code>X_test = NULL</code>, the list contains
one vector of length <code>n_train * num_trees</code>, where <code>n_train = nrow(X_train)</code></p>


<p>and <code>num_trees</code> is the number of trees in <code>bart_model</code>. If <code>X_test</code> is not <code>NULL</code>,
the list contains another vector of length <code>n_test * num_trees</code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Drew Herren, Richard Hahn, Jared Murray, Carlos Carvalho, Jingyu He.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

